<?xml version="1.0"?>
<!--
 * SMCommerce
 *
 * @category  SM
 * @package   SM_AmastyShopby
 *
 * Date: June, 11 2020
 * Time: 1:54 PM
 * User: VooThanh DEV
 *
 * @author    SMCommerce Core Team <connect@smartosc.com>
 * @copyright Copyright SMCommerce (http://smartosc.com/)
 -->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <type name="Amasty\Shopby\Model\Layer\Filter\Category">
        <plugin name="trans_shopby_model_filter_category" disabled="true"/>
    </type>
    <!-- Elastcisearch plugins -->
    <type name="Magento\Elasticsearch\SearchAdapter\Mapper">
        <plugin name="Amasty_Shopby::updateElasticQuery"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Mapper"/>
    </type>
    <type name="Magento\Elasticsearch\Elasticsearch5\SearchAdapter\Mapper">
        <plugin name="Amasty_Shopby::updateElasticQuery"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Mapper"/>
    </type>
    <type name="Mirasvit\SearchElastic\Adapter\Mapper">
        <plugin name="Amasty_Shopby::MirasvitUpdateElasticQuery"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Mapper"/>
    </type>
    <type name="Amasty\ElasticSearch\Model\Search\GetRequestQuery">
        <plugin name="Amasty_Shopby::ElasticUpdateQuery"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Mapper"/>
    </type>
    <!--======================================================================-->
    <type name="Magento\Elasticsearch\SearchAdapter\Aggregation\Builder\Dynamic">
        <plugin name="Amasty_Shopby::AggregationDynamicAddTotals"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Aggregation\Builder\Dynamic"/>
    </type>
    <type name="Mirasvit\SearchElastic\Adapter\Aggregation\DynamicBucket">
        <plugin name="Amasty_Shopby::MirasvitAggregationDynamicAddTotals"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Aggregation\Builder\Dynamic"/>
    </type>
    <type name="Amasty\ElasticSearch\Model\Search\GetResponse\GetAggregations">
        <plugin name="Amasty_Shopby::ElasticAggregationDynamicAddTotals"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Aggregation\Builder\Dynamic"/>
        <plugin name="Amasty_Shopby::ElasticAggregationTermAddTotals"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Aggregation\Builder\Term"/>
    </type>
    <!--======================================================================-->
    <type name="Magento\Elasticsearch\SearchAdapter\Aggregation\Builder\Term">
        <plugin name="Amasty_Shopby::AggregationTermAddTotals"
                type="Amasty\Shopby\Plugin\Elasticsearch\SearchAdapter\Aggregation\Builder\Term"/>
    </type>
    <!-- Untill all buckets will be evaluated in 1 request-->
    <type name="Magento\Framework\Search\Dynamic\Algorithm\Repository">
        <plugin name="Amasty_Shopby::DynamicAlgorithmRepositoryAroundGet"
                type="Amasty\Shopby\Plugin\Framework\Search\Dynamic\Algorithm\Repository"/>
    </type>
    <!--======================================================================-->
    <type name="Amasty\Shopby\Model\ResourceModel\Fulltext\Collection">
        <plugin name="add_catalog_permissions_information"
                type="Amasty\Shopby\Plugin\ElasticsearchCatalogPermissions\Plugin\AddCategoryPermissionsToCollectionPlugin"/>
    </type>
    <type name="Magento\Framework\Search\Request">
        <plugin name="Amasty_Shopby::undefinedSearchFix"
                type="Amasty\ShopbyBase\Plugin\Framework\Search\RequestPlugin"/>
    </type>
    <type name="Magento\Catalog\Block\Product\ProductList\Toolbar">
        <plugin name="Amasty_Shopby::ProductListToolbar"
                type="Amasty\Shopby\Plugin\Catalog\Block\Product\ProductList\Toolbar"/>
    </type>
</config>