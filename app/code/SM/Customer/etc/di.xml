<?xml version="1.0"?>
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <!-- Declare interface -->
    <preference for="SM\Customer\Api\TransCustomerRepositoryInterface"
                type="SM\Customer\Model\ResourceModel\CustomerRepository"/>
    <preference for="SM\Customer\Api\TransCustomerProfileInterface"
                type="SM\Customer\Model\TransCustomerProfile"/>
    <preference for="Magento\Customer\Model\Authentication"
                type="SM\Customer\Model\Authentication"/>
    <preference for="SM\Customer\Api\TransCustomerManagementInterface"
                type="SM\Customer\Model\ResourceModel\CustomerManagement"/>
    <preference for="SM\Customer\Api\AddressManagementInterface"
                type="SM\Customer\Model\AddressManagement"/>
    <preference for="SM\Customer\Api\Data\CustomerDeviceSearchResultInterface"
                type="Magento\Framework\Api\SearchResults"/>
    <preference for="SM\Customer\Api\Data\CustomerDeviceInterface"
                type="SM\Customer\Model\Data\CustomerDevice"/>
    <preference for="SM\Customer\Api\CustomerDeviceRepositoryInterface"
                type="SM\Customer\Model\CustomerDeviceRepository"/>
    <preference for="SM\Customer\Api\ProvinceInterface"
                type="SM\Customer\Model\Province"/>
    <preference for="SM\Customer\Api\CustomerInterface"
                type="SM\Customer\Model\Customer"/>

    <preference for="SM\Customer\Api\Data\CustomerOptionInterface"
                type="SM\Customer\Model\Data\CustomerOption"/>

    <!-- Social login -->
    <preference for="Mageplaza\SocialLogin\Controller\Social\Login" type="SM\Customer\Controller\Social\Login"/>
    <preference for="Mageplaza\SocialLogin\Controller\Social\Callback" type="SM\Customer\Controller\Social\Callback"/>
    <preference for="SM\Customer\Api\CustomerTokenServiceInterface" type="SM\Customer\Model\CustomerTokenService"/>
    <preference for="SM\Customer\Api\Data\SocialProfileRepositoryInterface"
                type="SM\Customer\Model\SocialProfileRepository"/>

    <!-- always build url for frontend area -->
    <type name="SM\Customer\Model\Email\Preparator">
        <arguments>
            <argument name="urlBuilder" xsi:type="object">Magento\Framework\Url</argument>
        </arguments>
    </type>

    <!-- Plugin -->
    <type name="Magento\Customer\Api\CustomerRepositoryInterface">
        <plugin name="sm_customer_magento_customer_api_customerRepositoryInterface"
                type="SM\Customer\Plugin\Magento\Customer\Api\CustomerRepositoryInterface" />
        <plugin name="sm_customer_telephone_resolver_before_save"
                type="SM\Customer\Plugin\Magento\Customer\Api\TelephoneResolverPlugin" />
    </type>

    <type name="Magento\Customer\Api\AccountManagementInterface">
        <plugin name="sm_customer_magento_customer_api_accountManagementInterface"
                type="SM\Customer\Plugin\Magento\Customer\Api\AccountManagementInterface" />
    </type>

    <type name="Magento\Customer\Model\AuthenticationInterface">
        <plugin name="sm_customer_magento_customer_api_accountManagementInterface"
                type="SM\Customer\Plugin\Magento\Customer\Model\AuthenticationInterface" />
    </type>

    <type name="Magento\Customer\Controller\Account\Logout">
        <plugin name="sm_customer_magento_customer_controller_account_logout"
                type="SM\Customer\Plugin\Magento\Customer\Controller\Account\Logout" />
    </type>

    <type name="Magento\Customer\Model\EmailNotificationInterface">
        <plugin name="sm_customer_magento_customer_model_emailNotificationInterface"
                type="SM\Customer\Plugin\Magento\Customer\Model\EmailNotificationInterface" />
    </type>

    <type name="SM\Customer\Api\TransCustomerRepositoryInterface">
        <plugin name="sm_customer_social_register_api"
                type="SM\Customer\Plugin\SM\Customer\Api\TransCustomerRepositoryInterface" />
    </type>

    <type name="Magento\Customer\Model\Customer">
        <plugin name="sm_customer_data_plugin" type="SM\Customer\Plugin\Magento\Customer\Model\Customer" />
    </type>

    <type name="\Magento\Customer\Model\Address\CustomAttributesProcessor">
        <plugin name="sm_customer_attribute_processor"
                type="\SM\Customer\Plugin\Magento\Customer\Model\Address\CustomAttributesProcessor" sortOrder="50" />
    </type>
</config>
